---
title: "chapter 13-1HW-2"
author: "Min-Yao"
date: "2020/1/10"
output: html_document
---

### Medium.

### 12M1. Revisit the Reed frog survival data, data(reedfrogs), and add the predation and size treatment variables to the varying intercepts model. Consider models with either main effect alone, both main effects, as well as a model including both and their interaction. Instead of focusing on inferences about these two predictor variables, focus on the inferred variation across tanks. Explain why it changes as it does across models.

```{r}
## R code 13.1
library(rethinking)
data(reedfrogs)
d <- reedfrogs
str(d)
head(d)
```

```{r}
# make the tank cluster variable
d$tank <- 1:nrow(d)
d$has_pred<- ifelse(test = d$pred == "pred", yes = 1, no = 0)
d$is_big<- ifelse(test = d$size == "big", yes = 1, no = 0)
str(d)

dat <- list(
    S = d$surv,
    N = d$density,
    P = d$has_pred,
    B = d$is_big,
    tank = d$tank )

str(dat)
```

```{r}
## R code 13.3+both
m13.2.both <- ulam(
    alist(
        S ~ dbinom( N , p ) ,
        logit(p) <- a[tank] + b_predation*P + b_size*B,
        a[tank] ~ dnorm( a_bar , sigma ) ,
        a_bar ~ dnorm( 0 , 1.5 ) ,
        sigma ~ dexp( 1 ),
        b_predation ~ dnorm(0, 1),
        b_size ~ dnorm(0, 1)
    ), data=dat , chains=4 , log_lik=TRUE )

precis(m13.2.both)
compare(m13.2, m13.2.both)
plot(compare(m13.2, m13.2.both))
```

```{r}
## R code 13.3+both+interaction
m13.2.interaction <- ulam(
    alist(
        S ~ dbinom( N , p ) ,
        logit(p) <- a[tank] + b_predation*P + b_size*B + b_pred_size*P*B,
        a[tank] ~ dnorm( a_bar , sigma ) ,
        a_bar ~ dnorm( 0 , 1.5 ) ,
        sigma ~ dexp( 1 ),
        b_predation ~ dnorm(0, 1),
        b_size ~ dnorm(0, 1),
        b_pred_size ~ dnorm(0, 1)
    ), data=dat , chains=4 , log_lik=TRUE )

precis(m13.2.interaction)
compare(m13.2, m13.2.interaction)
plot(compare(m13.2, m13.2.interaction))
```